Решается в лоб по условию
создадим список накопительных сумм для быстрого подсчёта количества символов в какой-то части матрицы, чтобы не перебирать каждый символ заново
далее пройдёмся по каждой квартире, матрица делится на маленькие подматрицы, каждая соответствует одной квартире, определяем их границы и подсчитываем общее число включенного света, используя накопленные суммы
проверяем при подсчёте достигает ли порога

как по идее надо решать для наименьшей асимптотики
Чисто в теории надо перебрать все левые верхние углы каждой квартиры